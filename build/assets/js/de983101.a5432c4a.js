"use strict";(self.webpackChunkomm_docs=self.webpackChunkomm_docs||[]).push([[938],{3386:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>d});var n=i(5893),r=i(1151);const o={id:"icx-delegation-script",title:"ICX delegation script",description:"If you're an ICON validator, learn how to use this script to track the votes you receive through Omm.",slug:"/icx-delegation-script",sidebar_position:5},s="ICX delegation script",a={id:"reference/icx-delegation-script",title:"ICX delegation script",description:"If you're an ICON validator, learn how to use this script to track the votes you receive through Omm.",source:"@site/docs/reference/icx-delegation-script.md",sourceDirName:"reference",slug:"/icx-delegation-script",permalink:"/icx-delegation-script",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{id:"icx-delegation-script",title:"ICX delegation script",description:"If you're an ICON validator, learn how to use this script to track the votes you receive through Omm.",slug:"/icx-delegation-script",sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"Smart contracts",permalink:"/smart-contracts"},next:{title:"Testnet app",permalink:"/testnet"}},c={},d=[{value:"Run the ICX delegation script",id:"run-the-icx-delegation-script",level:2},{value:"Verify the votes",id:"verify-the-votes",level:2},{value:"Promote your incentives",id:"promote-your-incentives",level:2}];function l(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",...(0,r.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"icx-delegation-script",children:"ICX delegation script"}),"\n",(0,n.jsx)(t.p,{children:"If you're an ICON validator, learn how to use this script to track the votes you receive through Omm."}),"\n",(0,n.jsxs)(t.p,{children:["bOMM holders can participate in ICON\u2019s voting system by delegating ICX from the ICON market towards up to 5 ICON validators (see ",(0,n.jsx)(t.a,{href:"/vote-validators",children:"Vote for ICON validators"}),")."]}),"\n",(0,n.jsx)(t.p,{children:"Some validators offer voting incentives to ICX stakers. bOMM has more voting power than staked ICX \u2013 and it's cheaper \u2013 so validators can use the ICX delegation script to offer incentives to bOMM holders."}),"\n",(0,n.jsxs)(t.p,{children:["The delegation script (",(0,n.jsx)(t.a,{href:"https://github.com/openmoneymarket/openmoneymarket-mono/tree/development/scripts/prep-icx-delegations",children:"view on GitHub"}),") fetches the wallet addresses used to vote for a specific validator, and their voting power in ICX. The output is saved to a JSON file using this format:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:'{\n    "hx04c8c5e5f412aa7c1986514bbbef2d269a2733fc": 466204891016976169228621,\n    "hx989fa78200b23ca042e52e370128ee141187f443": 438638739301371746761613,\n    "hx1be60841025db1b22126ba08ba519326603029c9": 342672743228696263962315,\n    "hx5933fba534f5152ab435e02f7067e4729affa92e": 250278905329592107143901,\n    "hx90899b65c16139ad4983a7a570c17db84c5162c4": 217572371437773081042390,\n    "hx1747aeab5afbdabd85af027ae249897cd5165146": 199561909138062903960000,\n    "hxa777652bb82b6e6a88678f2b5ccda93e3163ebc2": 156338462634667962819797\n}\n'})}),"\n",(0,n.jsx)(t.h2,{id:"run-the-icx-delegation-script",children:"Run the ICX delegation script"}),"\n",(0,n.jsx)(t.p,{children:"First, make sure you have Python 3 and PIP installed on your device. Then:"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsx)(t.li,{children:"Install the required libraries:"}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.code,{children:"pip3 install -r requirements.txt"})}),"\n",(0,n.jsxs)(t.ol,{start:"2",children:["\n",(0,n.jsx)(t.li,{children:"Run the script to fetch a list of wallet addresses and their voting power for a specific validator (also known as a P-Rep):"}),"\n"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{children:"python3 prep-icx-delegations.py -prep PREP_ADDRESS\npython3 prep-icx-delegations.py -prep hx0000000000000000000000000000000000000000\n"})}),"\n",(0,n.jsxs)(t.ol,{start:"3",children:["\n",(0,n.jsxs)(t.li,{children:["Open the ",(0,n.jsx)(t.code,{children:"timestamp_prepaddress_delegations.json"})," file the script created, then divide the number beside each wallet address by 1,000,000,000,000,000,000 (10^18) to get the ICX amount."]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"verify-the-votes",children:"Verify the votes"}),"\n",(0,n.jsx)(t.p,{children:"Community trackers don't pick up the votes cast via Omm, because the votes are routed through the Balanced staking contract before they're assigned to a validator."}),"\n",(0,n.jsxs)(t.p,{children:["To verify how much ICX the ",(0,n.jsx)(t.a,{href:"https://tracker.icon.community/contract/cx43e2eec79eb76293c298f2b17aec06097be606e0",children:"staking contract"})," has delegated to a validator on behalf of Omm:"]}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:["Go to the ",(0,n.jsx)(t.a,{href:"https://tracker.icon.community/contract/cx43e2eec79eb76293c298f2b17aec06097be606e0",children:"staking contract"})," and click the Read Contract tab."]}),"\n",(0,n.jsxs)(t.li,{children:["Find ",(0,n.jsx)(t.code,{children:"getAddressDelegations"}),", then query Omm's lending pool contract address: ",(0,n.jsx)(t.code,{children:"cxfb312bbd0a244b9e7bb5794c91f4e4acc41dea94"}),"."]}),"\n",(0,n.jsx)(t.li,{children:"Locate your validator address, then copy the value beside it."}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"https://www.rapidtables.com/convert/number/hex-to-decimal.html",children:"Convert the hexadecimal value"}),", then divide the result by 1,000,000,000,000,000,000 (10^18)."]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"promote-your-incentives",children:"Promote your incentives"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.a,{href:"/vote-validators",children:"Vote for ICON validators"})," includes details about validator incentives that support Omm users. The app also indicates which validators offer incentives, so it's easier for voters to choose."]}),"\n",(0,n.jsxs)(t.p,{children:["If you offer incentives, reach out on Discord so we can add your details to the ",(0,n.jsx)(t.a,{href:"/validator-incentives",children:"Validator incentives page"}),"."]})]})}function h(e={}){const{wrapper:t}={...(0,r.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},1151:(e,t,i)=>{i.d(t,{Z:()=>a,a:()=>s});var n=i(7294);const r={},o=n.createContext(r);function s(e){const t=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),n.createElement(o.Provider,{value:t},e.children)}}}]);